---
import { capitalCase } from 'change-case'

import Sketch from '@/components/Sketch.astro'
import SketchLayout from '@/layouts/SketchLayout.astro'

export const prerender = true

const { pathname } = Astro.url
const title = capitalCase(pathname.split('/').pop() ?? '')
---

<script>
  import { getDimensions } from '@/utils/getDimensions'
  import { sketch, drawBorder } from '@/utils/p5'
  import type { Draw } from '@/utils/p5'

  const dimensions: number[] = getDimensions('A4')
  const padding: number[] = [40]
  const length = 80
  const circles = Array.from({ length })
  let margin: number

  const draw: Draw = p5 => {
    p5.clear(0, 0, 0, 0)
    p5.noFill()
    margin = p5.width * 0.05

    drawBorder(p5, margin)

    const cx = p5.width * 0.5
    const cy = p5.height * 0.5

    circles.map((_, i) => {
      const radius = (p5.TWO_PI / length) * i
      const x = cx + p5.cos(radius) * (p5.width * 0.25)
      const y = cy + p5.sin(radius) * (p5.width * 0.25)

      p5.circle(x, y, 10)
    })
  }

  sketch({
    draw,
    dimensions,
    padding,
    renderer: 'svg',
    suffix: 'radical-radials'
  })
</script>

<SketchLayout {title}>
  <Sketch />
</SketchLayout>
