---
import { capitalCase } from 'change-case'

import Sketch from '@/components/Sketch.astro'
import Layout from '@/layouts/Layout.astro'

export const prerender = true

const { pathname } = Astro.url
const title = capitalCase(pathname.split('/').pop() ?? '')
---

<script>
  import P5 from 'p5'
  import { setupDefaults } from '@/utils/p5'

  type Sketch = (p5: P5) => void

  const sketch: Sketch = p5 => {
    const dimensions: number[] = [1200, 1200]
    const padding: number[] = [40]
    const background = [255, 253, 252]

    p5.setup = () => {
      setupDefaults({
        p5,
        dimensions,
        padding,
        canvasParentRef: 'container'
      })
    }

    p5.draw = () => {
      p5.background(background)
      p5.ellipse(50, 50, 80, 80)
    }
  }

  new P5(sketch, 'container' as unknown as HTMLElement)
</script>
<Layout {title}>
  <Sketch />
</Layout>
